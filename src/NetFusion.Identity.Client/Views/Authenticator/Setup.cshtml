@model AuthenticatorSetupModel

<h3>Authenticator</h3>

<div class="alert alert-info" role="alert">
    This page allows an mobile or desktop authenticator to be enabled.
    When enabled, you will be required to enter a key generated by the
    authenticator after entering a correct email address and password.
</div>

<div asp-validation-summary="All" class="text-danger"></div>

<h4>Configuration</h4>
<p>
    Complete the following steps to download and install an Authenticator application. 
</p>
<ol>
    <li>
        <p>
            Download a two-factor authenticator app like Microsoft Authenticator for
            <a href="https://go.microsoft.com/fwlink/?Linkid=825072">Android</a> and
            <a href="https://go.microsoft.com/fwlink/?Linkid=825073">iOS</a> or
            Google Authenticator for
            <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&amp;hl=en">Android</a> and
            <a href="https://itunes.apple.com/us/app/google-authenticator/id388497605?mt=8">iOS</a>.
        </p>
    </li>
    <li>
        <p>Scan the QR Code or enter this key <kbd>@Model.Key</kbd> into your two factor authenticator app. Spaces and 
            casing do not matter.
        </p>
        <div id="qrCode"></div>
        <div id="qrCodeData" data-url="@Html.Raw(Model.QrCodeUrl)"></div>
    </li>
    <li>
        <p>
            Once you have scanned the QR code or input the key above, your two factor authentication app will provide 
            youwith a unique code. Enter the code in the confirmation box below.
        </p>
        <div class="row">
            <div class="col-md-6">
                <form method="post" asp-action="Setup">
                    <input type="hidden" asp-for="Key" />
                    <input type="hidden" asp-for="QrCodeUrl" />
                    <div>
                        <label asp-for="SetupToken" class="control-label form-label">Verification Code</label>
                        <input asp-for="SetupToken" class="form-control" autocomplete="off" />
                    </div>
                    <button type="submit" class="w-100 btn btn-lg btn-primary">Verify</button>
                </form>
            </div>
        </div>
    </li>
</ol>

@section Scripts
{
    <script type="text/javascript" src="/lib/qrcode/qrcode.min.js"></script>
    <script type="text/javascript">
        new QRCode(document.getElementById("qrCode"), {
            text: document.getElementById("qrCodeData").getAttribute("data-url"),
            width: 150,
            height: 150
        });
    </script>
}